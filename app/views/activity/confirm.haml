
%div{'data-role' => 'content'}
  %p.greeting
    恭喜你获得
    %span.prize=@lottery.level_name
    ！
  %p 
    奖品是
    %span.prize=@lottery.display_name
  %p 请您完整填写以下信息，方便我们联系您！

  = form_for :lottery, url(:activity, :save, :id => @lottery.id) do |f|
    - errors = @lottery.errors
    = f.hidden_field :serial
    - if @lottery.level == '4'
      %p
        = f.label :tel, :caption => '您输请您要充值入的手机号:'
        -if errors.include?(:tel)
          = f.telephone_field :tel, :autofocus => true
          %span.error= f.error_message_on(:tel)
        -else
          = f.telephone_field :tel
    - if ['1','2'].include?(@lottery.level)
      %p
        = f.label :product, :caption => '您所购买的产品号:'
        -if errors.include?(:product)
          = f.text_field :product, :autofocus => true
          %span.error= f.error_message_on(:product)
        -else
          = f.text_field :product
    = f.fields_for :user do |user|
      :javascript
        $(document).one('pageshow', function() {
          $('#address').citySelect({
            nodata: "none",
            prov: "#{user.object.province}",
            city: "#{user.object.city}",
            required: false
          });
        });
      = user.hidden_field :openid
      - errors = @lottery.user.errors
      %p
        = user.label :name
        -if errors.include?(:name)
          = user.text_field :name, :autofocus => true
          %span.error= user.error_message_on(:name)
        -else
          = user.text_field :name
      %p
        = user.label :tel
        -if errors.include?(:tel)
          =user.telephone_field :tel, :autofocus => true
          %span.error= user.error_message_on(:tel)
        -else 
          = user.telephone_field :tel
      %p
        = user.label :workshop, :caption => '您所在的修理厂名称:'
        -if errors.include?(:workshop)
          = user.text_field :workshop, :autofocus => true
          %span.error= user.error_message_on(:workshop) 
        -else
          = user.text_field :workshop
      %p{:id => 'address'}

        = user.label :workshop_address, :caption => '您所在的修理厂地址:'
        -if errors.include?(:province)
          = user.select :province, :class => 'prov', :autofocus => true, 'data-inline' => "true"
        -else
          = user.select :province, :class => 'prov', 'data-inline' => "true"

        -if errors.include?(:city)
          = user.select :city, :class => 'city', :autofocus => true, 'data-inline' => "true"
        -else
          = user.select :city, :class => 'city', 'data-inline' => "true"

        = user.label :workshop_address, :caption => '详细地址:'
        -if errors.include?(:workshop_address)
          = user.text_area :workshop_address, :autofocus => true
          %span.error= user.error_message_on(:workshop_address)
        -else
          = user.text_area :workshop_address
    = f.submit_block t('activity.result.save')
